<!doctype html>
<html><head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Jobs</title>
  <link rel="stylesheet" href="../style.css"/>
  <style>
/* Portal-native FSM skin */
.fsm-body {
  background: #e6e8eb url('../Mostlane_Embossed.png') no-repeat fixed;
  background-size: 180% auto;
  margin: 0;
  min-height: 100vh;
  font-family: Arial, sans-serif;
}
.fsm-wrap {
  max-width: 820px;
  margin: 0 auto;
  padding: 16px;
  text-align: left;
}
.fsm-header {
  background-color: #003366; /* portal blue */
  color: #fff;
  border-radius: 8px;
  padding: 10px 14px;
  display:flex; align-items:center; gap:10px;
}
.fsm-header img { height: 38px; width: auto; }
.fsm-header .title { font-size: 18px; font-weight: 700; margin: 0; }
.fsm-box {
  background: rgba(255,255,255,0.60);
  border-radius: 12px;
  padding: 14px;
  margin: 16px 0;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
}
.fsm-grid2 { display: grid; grid-template-columns: 1fr; gap: 12px; }
@media (min-width: 720px) { .fsm-grid2 { grid-template-columns: 1fr 1fr; } }
.fsm-kpi { background: rgba(255,255,255,0.70); border-radius: 12px; padding: 12px; }
.fsm-kpi .v { font-weight: 800; font-size: 24px; }
.fsm-kpi .l { color: #5f6876; font-size: 12px; margin-top: 4px; }
.fsm-input, .fsm-select, .fsm-textarea {
  width: 100%; padding: 12px 14px; border-radius: 10px;
  border: 1px solid #d6dbe1; background: #fff; font-size: 15px;
}
.fsm-btn { display:inline-block; padding:12px 16px; border-radius: 10px; border:1px solid #003366;
           background:#e6f0fa; color:#003366; font-weight:700; text-decoration:none; }
.fsm-btn.primary { background:#003366; color:#fff; }
.fsm-row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.fsm-card { background: rgba(255,255,255,0.70); border-radius: 12px; padding: 12px; margin: 10px 0; }
.fsm-meta { color:#5f6876; font-size:12px; }
.fsm-chip { font-size:12px; padding:6px 10px; border-radius:999px; color:#fff; font-weight:800; display:inline-block; }
.fsm-New { background:#9aa7b6 } .fsm-Assigned { background:#003366 } .fsm-InProgress { background:#f1a331 }
.fsm-Completed { background:#23966e } .fsm-OnHold { background:#7d8694 } .fsm-Cancelled { background:#a1a7b2 }
.fsm-footer { text-align:center; padding-bottom: 40px; color:#5f6876; font-size:12px }
</style>
  <script defer src="assets/app.js"></script>
  <script>
  function render(){
    const q=document.getElementById('q').value.toLowerCase();
    const s=document.getElementById('status').value;
    let arr=MFSM.loadJobs();
    if(q) arr=arr.filter(j=>(j.id+j.title+(j.site||'')).toLowerCase().includes(q));
    if(s!=='All') arr=arr.filter(j=>j.status===s);
    arr.sort((a,b)=>new Date(b.updatedAt||b.createdAt)-new Date(a.updatedAt||a.createdAt));
    const list=document.getElementById('list'); list.innerHTML='';
    for(const j of arr){
      const d=document.createElement('div'); d.className='fsm-card';
      const st='fsm-'+j.status.replace(' ','');
      d.innerHTML=`<div class="fsm-row" style="justify-content:space-between">
        <div><strong>${j.id}</strong> — ${j.title}</div>
        <span class="fsm-chip ${st}">${j.status}</span></div>
        <div class="fsm-meta">${j.site||''} · Due ${j.dueDate? new Date(j.dueDate).toLocaleString():'—'}</div>
        <div class="fsm-row"><a class="fsm-btn" href="job.html?id=${j.id}">Open</a></div>`;
      list.appendChild(d);
    }
  }
  document.addEventListener('DOMContentLoaded',()=>{ render();
    document.getElementById('q').addEventListener('input',render);
    const s=document.getElementById('status');
    s.innerHTML='<option>All</option>'+MFSM.Statuses.map(x=>`<option>${x}</option>`).join('');
    s.addEventListener('change',render);
  });
  </script>
</head>
<body class="fsm-body">
  <div class="fsm-wrap">
    
<div class="fsm-header">
  <img src="../mostlane-logo.jpg" alt="Mostlane logo"/>
  <h2 class="title">Jobs</h2>
</div>

    <div class="fsm-box">
      <div class="fsm-grid2">
        <div><div class="fsm-meta">Search</div><input id="q" class="fsm-input" placeholder="Job ID, title, site..."/></div>
        <div><div class="fsm-meta">Status</div><select id="status" class="fsm-select"></select></div>
      </div>
    </div>
    <div class="fsm-box" id="list"></div>
    <div class="fsm-footer">Mostlane Portal – FSM</div>
  </div>
</body></html>
