
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mostlane Portal Login</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="login-body">
    <div class="login-container">
        <img src="mostlane-logo.jpg" alt="Mostlane Logo" class="login-logo">
        <form id="loginForm">
            <input type="text" id="username" placeholder="Username" required>
            <input type="password" id="password" placeholder="Password" required>
            <button type="submit">Sign In</button>
            <p id="error" class="error-message"></p>
            <p class="signup-link"><a href="https://your-signup-link">Sign Up</a></p>
        </form>
    </div>

<script>
// Hardcoded admin credentials
const adminUsername = "Admin"; // Capital A
const adminPasswordHash = "7de84fd55c26dbc28df9421e507cdc42981ff57e5f88af6d0066d6a676989a6d";

// Function to hash password input
async function hashPassword(password) {
  const msgUint8 = new TextEncoder().encode(password);
  const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  return hashHex;
}

// Login function
document.getElementById('loginForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const enteredUsername = document.getElementById('username').value.trim();
  const enteredPassword = document.getElementById('password').value.trim();

  if (enteredUsername === adminUsername) {
    const hashed = await hashPassword(enteredPassword);
    if (hashed === adminPasswordHash) {
      // Admin login successful
      sessionStorage.setItem('mostlaneLoggedIn', 'true');
      sessionStorage.setItem('filePath', 'https://yourcompany.sharepoint.com/sites/Portal/Admin'); // Update this URL if needed
      window.location.href = "main.html";
      return;
    } else {
      document.getElementById("error").textContent = "Incorrect Admin password.";
      return;
    }
  }

  // Normal user login using users.json
  fetch('https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/users.json')
    .then(response => response.json())
    .then(users => {
      const user = users.find(u => u.username.toLowerCase() === enteredUsername.toLowerCase() && u.password === enteredPassword);
      if (user) {
        sessionStorage.setItem('mostlaneLoggedIn', 'true');
        sessionStorage.setItem('filePath', user.filepath);
        window.location.href = "main.html";
      } else {
        document.getElementById("error").textContent = "Invalid login credentials.";
      }
    })
    .catch(error => {
      console.error('Error fetching users.json:', error);
      document.getElementById("error").textContent = "Login system error. Please contact admin.";
    });
});
</script>
</body>
</html>
